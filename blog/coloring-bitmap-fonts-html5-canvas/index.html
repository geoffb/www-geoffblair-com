<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="description"><meta name="keywords"><meta name="viewport" content="width=device-width, initial-scale=1"><title>Coloring Bitmap Fonts in HTML5 Canvas</title><link href="/media/stylesheets/combo.css" rel="stylesheet" type="text/css"><link href="/media/stylesheets/prism.css" rel="stylesheet" type="text/css"></head><body><header><div class="content"><nav><ul><li><a href="/">Home</a></li><li><a href="/games">Games</a></li><li><a href="/about">About</a></li><li><a href="/resume">Resume</a></li></ul></nav></div></header><main class="article"><h1>Coloring Bitmap Fonts in HTML5 Canvas</h1><p class="date">April 10, 2016</p><div><p>When rendering text in HTML5 canvas, I mostly use the <a href="https://developer.mozilla.org/en-US/docs/Web/API/Canvas_API/Tutorial/Drawing_text">native text drawing methods</a> like <code>fillText</code>. However, a question came up on the <a href="http://forum.lostdecadegames.com/">LDG forum</a> a while back about rendering bitmap fonts with varying colors.</p>
<p>Bitmap fonts are simply images of text characters which are then rendered to the screen the same way you might render game sprites, with <code>drawImage</code>.</p>
<p>The source image for a bitmap font would look something like this:</p>
<a href="https://github.com/geoffb/canvas-bitmap-fonts/blob/master/font.png">
	<img src="https://raw.githubusercontent.com/geoffb/canvas-bitmap-fonts/master/font.png" width="700" />
</a>
<p>In order to render this font using different colors, we can take advantage of the <a href="https://developer.mozilla.org/en-US/docs/Web/API/CanvasRenderingContext2D/globalCompositeOperation">composite operations</a> supported by canvas.</p>
<p>The basic concept is to first draw the letters to an off-screen buffer canvas and then use the <code>source-in</code> composite operation to draw over just the black pixels with a different color.</p>
<p><em>Note: This example doesn't cover how to render a string of text by mapping each character to a position in the image.</em></p>
<p>Here's a snippet of JavaScript demonstrating how the compositing works:</p>
<pre class="language-js"><code class="language-js"><span class="token comment">// Draw mask to buffer</span><br>ctx<span class="token punctuation">.</span><span class="token function">clearRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> buffer<span class="token punctuation">.</span>width<span class="token punctuation">,</span> buffer<span class="token punctuation">.</span>height<span class="token punctuation">)</span><span class="token punctuation">;</span><br>ctx<span class="token punctuation">.</span><span class="token function">drawImage</span><span class="token punctuation">(</span>font<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Draw the color only where the mask exists</span><br>ctx<span class="token punctuation">.</span>fillStyle <span class="token operator">=</span> <span class="token string">"white"</span><span class="token punctuation">;</span><br>ctx<span class="token punctuation">.</span>globalCompositeOperation <span class="token operator">=</span> <span class="token string">"source-in"</span><span class="token punctuation">;</span><br>ctx<span class="token punctuation">.</span><span class="token function">fillRect</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">256</span><span class="token punctuation">,</span> <span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">;</span><br><br><span class="token comment">// Now, render the contents of the buffer to the screen</span></code></pre>
<p>Using this technique, we can render text in any color using a single bitmap font image:</p>
<a href="https://github.com/geoffb/canvas-bitmap-fonts/blob/master/font.png">
	<img src="https://raw.githubusercontent.com/geoffb/canvas-bitmap-fonts/master/output.png" width="263" />
</a>
<p><a href="https://github.com/geoffb/canvas-bitmap-fonts">View the full source on GitHub</a>.</p>
</div></main><footer><p>Â© Geoff Blair</p></footer><script src="/media/scripts/prism.js"></script></body></html>