<!doctype html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><meta name="description" content="The first development log for Gloomstone, my first-person dungeon crawling game engine."><meta name="keywords" content="gloomestone, gamedev, devlog"><title>Gloomstone Devlog #1 - Geoff Blair</title><link rel="alternate" type="application/atom+xml" href="https://www.geoffblair.com/feed.xml" title="Geoff Blair"><meta property="og:site_name" content="Geoff Blair"><meta property="og:url" content="https://www.geoffblair.com/blog/gloomstone-devlog-1/"><meta property="og:type" content="article"><meta property="og:title" content="Gloomstone Devlog #1"><meta property="og:description" content="The first development log for Gloomstone, my first-person dungeon crawling game engine."><meta property="og:image" content="https://www.geoffblair.com/media/images/gloomstone/gloomstone-1200x630.png"><meta property="og:image:width" content="1200"><meta property="og:image:height" content="630"><link rel="stylesheet" type="text/css" href="/css/main.css"><link rel="stylesheet" type="text/css" href="/css/prism.css"></head><body><header><nav><ul><li><a href="/">Home</a></li><li><a href="/games/">Games</a></li><li><a href="/blog/">Posts</a></li><li><a href="/about/">About</a></li><li><a href="/subscribe/">Subscribe</a></li></ul></nav></header><main><h1>Gloomstone Devlog #1</h1><time>Jul 2, 2023</time><h2>What the heck is &quot;Gloomstone&quot;?</h2><p><a href="/media/images/gloomstone/gloomstone.png"><img src="/media/images/gloomstone/gloomstone.png" alt="Gloomstone"></a></p><p>&quot;Gloomstone&quot; is the working title for my in-progress first-person dungeon crawling game engine. Development is rather slow, being a side-project, but I've been making more visible progress lately. I'm trying to spend a few hours each week pushing it forward.</p><p>The engine is written in <a href="https://www.typescriptlang.org">TypeScript</a> and uses <a href="https://developer.mozilla.org/en-US/docs/Web/API/WebGL_API">WebGL</a> to render. My goal is to have as few dependencies as possible. As such, there are zero run-time dependencies, and only a few build-time dependencies: TypeScript, <a href="https://esbuild.github.io">esbuild</a>, and <a href="https://prettier.io">Prettier</a>.</p><p>Architecturally, the engine is a &quot;pure&quot; <a href="https://en.wikipedia.org/wiki/Entity_component_system">Entity component system</a>. &quot;Pure&quot;, to me, means that components have no behavior and systems have no state. Since classes are the very definition of coupling state and behavior, the <code>class</code> keyword does not appear anywhere in the source code. Of course this decision has trade-offs, and it's been an interesting exercise.</p><h2>Tiled Integration</h2><p><a href="/media/images/gloomstone/tiled.png"><img src="/media/images/gloomstone/tiled.png" alt="Editing a level in Tiled"></a></p><p>From the beginning of this project, I decided that <a href="https://www.mapeditor.org">Tiled</a>, a free and open source map editor, would be the source of truth for as much game data as possible. This helps strengthen the divide between source code and data, which I find to be in service of my architectural goals.</p><p>Whenever possible, I try to ensure that Tiled's basic features, such as ad-hoc objects with a sprite, work out of the box and as expected in the engine.</p><p>Tiled's <a href="https://doc.mapeditor.org/en/stable/manual/custom-properties/#custom-types">Custom Types</a> are used to define components, and <a href="https://doc.mapeditor.org/en/stable/manual/using-templates/">Templates</a> for prefabricated entities.</p><h2>Doors</h2><p><a href="/media/images/gloomstone/door.gif"><img src="/media/images/gloomstone/door.gif" alt="Door mechanism"></a></p><p>After implementing basic collision with the static walls, I wanted to add some button and door mechanics to make the world more interactive.</p><p>Buttons and doors are decoupled: Buttons respond to an interaction by sending a signal to a target entity (which is defined in Tiled). A door is a receiver of this signal and takes care of toggling and animating its state.</p><p>(The button is not currently visualized in the gif above, but exists on the wall tile with the sewer grate.)</p><h2>Floor Entities</h2><p><a href="/media/images/gloomstone/blood.png"><img src="/media/images/gloomstone/blood.png" alt="Blood floor entity"></a></p><p>This was a simple feature, allowing entities be laid flat as well as upright. Useful for ambiance (like the blood puddle above), floor traps, etc.</p><h2>Spikes</h2><p><a href="/media/images/gloomstone/spike.gif"><img src="/media/images/gloomstone/spike.gif" alt="Spike mechanism"></a></p><p>Spikes are a nice example of some composite behavior. They include a floor entity for the spike chamber, and a billboard entity which receives a toggle signal (much like the previously mentioned doors). To drive the interval, I added a &quot;timer&quot; component which sends a signal every <code>N</code> milliseconds to a target entity (in this case, itself).</p><p>There's a draw ordering bug when the spike retreats into its chamber, but overall I'm happy with the effect.</p></main><footer>Â© Geoff Blair</footer></body></html>